<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 663.1 1284" width="663.1" height="1284" style="--bg:#1a1b26;--fg:#a9b1d6;--line:#3d59a1;--accent:#7aa2f7;--muted:#565f89;background:var(--bg)">
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap');
  text { font-family: 'Inter', system-ui, sans-serif; }
  svg {
    /* Derived from --bg and --fg (overridable via --line, --accent, etc.) */
    --_text:          var(--fg);
    --_text-sec:      var(--muted, color-mix(in srgb, var(--fg) 60%, var(--bg)));
    --_text-muted:    var(--muted, color-mix(in srgb, var(--fg) 40%, var(--bg)));
    --_text-faint:    color-mix(in srgb, var(--fg) 25%, var(--bg));
    --_line:          var(--line, color-mix(in srgb, var(--fg) 30%, var(--bg)));
    --_arrow:         var(--accent, color-mix(in srgb, var(--fg) 50%, var(--bg)));
    --_node-fill:     var(--surface, color-mix(in srgb, var(--fg) 3%, var(--bg)));
    --_node-stroke:   var(--border, color-mix(in srgb, var(--fg) 20%, var(--bg)));
    --_group-fill:    var(--bg);
    --_group-hdr:     color-mix(in srgb, var(--fg) 5%, var(--bg));
    --_inner-stroke:  color-mix(in srgb, var(--fg) 12%, var(--bg));
    --_key-badge:     color-mix(in srgb, var(--fg) 10%, var(--bg));
  }
</style>
<defs>
  <marker id="seq-arrow" markerWidth="8" markerHeight="4.8" refX="8" refY="2.4" orient="auto-start-reverse">
    <polygon points="0 0, 8 2.4, 0 4.8" fill="var(--_arrow)" />
  </marker>
  <marker id="seq-arrow-open" markerWidth="8" markerHeight="4.8" refX="8" refY="2.4" orient="auto-start-reverse">
    <polyline points="0 0, 8 2.4, 0 4.8" fill="none" stroke="var(--_arrow)" stroke-width="1" />
  </marker>
</defs>
<rect x="30" y="78" width="603.1" height="500" rx="0" ry="0" fill="none" stroke="var(--_node-stroke)" stroke-width="1" />
<rect x="30" y="78" width="156.35999999999999" height="18" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="1" />
<text x="36" y="87" dy="0.35em" font-size="11" font-weight="600" fill="var(--_text-sec)">rect [rgb(30, 40, 70)]</text>
<rect x="301.75" y="586" width="331.35" height="280" rx="0" ry="0" fill="none" stroke="var(--_node-stroke)" stroke-width="1" />
<rect x="301.75" y="586" width="156.35999999999999" height="18" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="1" />
<text x="307.75" y="595" dy="0.35em" font-size="11" font-weight="600" fill="var(--_text-sec)">rect [rgb(40, 30, 70)]</text>
<rect x="30" y="874" width="409.54999999999995" height="360" rx="0" ry="0" fill="none" stroke="var(--_node-stroke)" stroke-width="1" />
<rect x="30" y="874" width="156.35999999999999" height="18" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="1" />
<text x="36" y="883" dy="0.35em" font-size="11" font-weight="600" fill="var(--_text-sec)">rect [rgb(30, 50, 40)]</text>
<line x1="80" y1="70" x2="80" y2="1254" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" />
<line x1="220" y1="70" x2="220" y2="1254" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" />
<line x1="370.65" y1="70" x2="370.65" y2="1254" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" />
<line x1="546.325" y1="70" x2="546.325" y2="1254" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" />
<rect x="365.65" y="228" width="10" height="290" fill="var(--_node-fill)" stroke="var(--_node-stroke)" stroke-width="0.75" />
<rect x="215" y="118" width="10" height="440" fill="var(--_node-fill)" stroke="var(--_node-stroke)" stroke-width="0.75" />
<rect x="365.65" y="1024" width="10" height="40" fill="var(--_node-fill)" stroke="var(--_node-stroke)" stroke-width="0.75" />
<rect x="215" y="914" width="10" height="300" fill="var(--_node-fill)" stroke="var(--_node-stroke)" stroke-width="0.75" />
<line x1="80" y1="118" x2="220" y2="118" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="150" y="112" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">memory_store_fact</text>
<polyline points="220,158 250,158 250,178 220,178" fill="none" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="256" y="168" dy="0.35em" font-size="11" font-weight="400" fill="var(--_text-muted)">Resolve scope name to ID</text>
<line x1="220" y1="228" x2="370.65" y2="228" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="295.325" y="222" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">storeFact mutation</text>
<polyline points="370.65,268 400.65,268 400.65,288 370.65,288" fill="none" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="406.65" y="278" dy="0.35em" font-size="11" font-weight="400" fill="var(--_text-muted)">Check write permission</text>
<polyline points="370.65,338 400.65,338 400.65,358 370.65,358" fill="none" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="406.65" y="348" dy="0.35em" font-size="11" font-weight="400" fill="var(--_text-muted)">Estimate importance</text>
<polyline points="370.65,408 400.65,408 400.65,428 370.65,428" fill="none" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="406.65" y="418" dy="0.35em" font-size="11" font-weight="400" fill="var(--_text-muted)">Insert fact</text>
<line x1="370.65" y1="478" x2="546.325" y2="478" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow-open)" />
<text x="458.4875" y="472" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">scheduler.runAfter 0</text>
<line x1="370.65" y1="518" x2="220" y2="518" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" marker-end="url(#seq-arrow)" />
<text x="295.325" y="512" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">factId + importanceScore</text>
<line x1="220" y1="558" x2="80" y2="558" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" marker-end="url(#seq-arrow)" />
<text x="150" y="552" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">Response in under 50ms</text>
<line x1="546.325" y1="626" x2="370.65" y2="626" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="458.4875" y="620" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">getFactInternal</text>
<line x1="370.65" y1="666" x2="546.325" y2="666" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" marker-end="url(#seq-arrow)" />
<text x="458.4875" y="660" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">fact data</text>
<polyline points="546.325,706 576.325,706 576.325,726 546.325,726" fill="none" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="582.325" y="716" dy="0.35em" font-size="11" font-weight="400" fill="var(--_text-muted)">Cohere Embed 4 1024-dim</text>
<polyline points="546.325,776 576.325,776 576.325,796 546.325,796" fill="none" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="582.325" y="786" dy="0.35em" font-size="11" font-weight="400" fill="var(--_text-muted)">Calculate importance</text>
<line x1="546.325" y1="846" x2="370.65" y2="846" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="458.4875" y="840" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">updateEnrichment</text>
<line x1="80" y1="914" x2="220" y2="914" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="150" y="908" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">memory_recall query</text>
<polyline points="220,954 250,954 250,974 220,974" fill="none" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="256" y="964" dy="0.35em" font-size="11" font-weight="400" fill="var(--_text-muted)">Get permitted scopes</text>
<line x1="220" y1="1024" x2="370.65" y2="1024" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="295.325" y="1018" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">searchFacts</text>
<line x1="370.65" y1="1064" x2="220" y2="1064" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" marker-end="url(#seq-arrow)" />
<text x="295.325" y="1058" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">matching facts</text>
<line x1="220" y1="1104" x2="370.65" y2="1104" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="295.325" y="1098" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">bumpAccess per fact</text>
<polyline points="220,1144 250,1144 250,1164 220,1164" fill="none" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="256" y="1154" dy="0.35em" font-size="11" font-weight="400" fill="var(--_text-muted)">Generate recallId</text>
<line x1="220" y1="1214" x2="80" y2="1214" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" marker-end="url(#seq-arrow)" />
<text x="150" y="1208" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">facts + recallId</text>
<rect x="165.325" y="74" width="120" height="27" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="0.75" />
<polygon points="279.325,74 285.325,80 279.325,80" fill="var(--_inner-stroke)" />
<text x="225.325" y="87.5" text-anchor="middle" dy="0.35em" font-size="11" font-weight="400" fill="var(--_text-muted)">Store Path</text>
<rect x="398.4875" y="562" width="120" height="27" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="0.75" />
<polygon points="512.4875,562 518.4875,568 512.4875,568" fill="var(--_inner-stroke)" />
<text x="458.4875" y="575.5" text-anchor="middle" dy="0.35em" font-size="11" font-weight="400" fill="var(--_text-muted)">Async Enrichment</text>
<rect x="165.325" y="850" width="120" height="27" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="0.75" />
<polygon points="279.325,850 285.325,856 279.325,856" fill="var(--_inner-stroke)" />
<text x="225.325" y="863.5" text-anchor="middle" dy="0.35em" font-size="11" font-weight="400" fill="var(--_text-muted)">Recall Path</text>
<rect x="40" y="30" width="80" height="40" rx="4" ry="4" fill="var(--_node-fill)" stroke="var(--_node-stroke)" stroke-width="1" />
<text x="80" y="50" text-anchor="middle" dy="0.35em" font-size="13" font-weight="500" fill="var(--_text)">Agent</text>
<rect x="168.25" y="30" width="103.5" height="40" rx="4" ry="4" fill="var(--_node-fill)" stroke="var(--_node-stroke)" stroke-width="1" />
<text x="220" y="50" text-anchor="middle" dy="0.35em" font-size="13" font-weight="500" fill="var(--_text)">MCP Server</text>
<rect x="311.75" y="30" width="117.80000000000001" height="40" rx="4" ry="4" fill="var(--_node-fill)" stroke="var(--_node-stroke)" stroke-width="1" />
<text x="370.65" y="50" text-anchor="middle" dy="0.35em" font-size="13" font-weight="500" fill="var(--_text)">Convex Cloud</text>
<rect x="469.55000000000007" y="30" width="153.55" height="40" rx="4" ry="4" fill="var(--_node-fill)" stroke="var(--_node-stroke)" stroke-width="1" />
<text x="546.325" y="50" text-anchor="middle" dy="0.35em" font-size="13" font-weight="500" fill="var(--_text)">Enrichment Action</text>
</svg>